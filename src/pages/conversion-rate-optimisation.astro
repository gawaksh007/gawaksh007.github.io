---
import MainLayout from "../layouts/MainLayout.astro";
import SectionTitle from "../components/ui/SectionTitle.astro";
import Form from "../components/ui/Form.astro";

// Case Studies Data
const caseStudies = [
  {
    icon: "üë•",
    title: "User Experience Analysis",
    desc: "Deep dive into user behavior and interaction patterns."
  },
  {
    icon: "üîÑ",
    title: "A/B & Multivariate Testing",
    desc: "Data-driven optimization through systematic testing."
  },
  {
    icon: "üìà",
    title: "Conversion Funnel Optimization",
    desc: "Streamline your conversion path for maximum results."
  },
  {
    icon: "üéØ",
    title: "Landing Page Optimization",
    desc: "Create high-converting landing pages that drive action."
  }
];

// Why it matters
const whyMatters = [
  { icon: "üöÄ", title: "Higher Conversions", desc: "Turn more visitors into customers with proven tactics." },
  { icon: "üí°", title: "Data-Driven Decisions", desc: "Every change is backed by analytics and testing." },
  { icon: "üìä", title: "Better ROI", desc: "Maximize the value of your existing traffic." },
  { icon: "üî¨", title: "Continuous Improvement", desc: "Ongoing optimization for compounding results." }
];

// Approach steps
const approach = [
  { step: 1, title: "Audit & Research", desc: "We analyze your funnel, user journeys, and analytics." },
  { step: 2, title: "Hypothesis & Planning", desc: "We identify opportunities and design experiments." },
  { step: 3, title: "Testing & Implementation", desc: "We run A/B tests and implement winning changes." },
  { step: 4, title: "Measurement & Iteration", desc: "We track results and refine for ongoing growth." }
];

// Case studies (placeholder)
const cases = [
  {
    client: "ShopEase",
    logo: "/bc.png",
    summary: "Landing page and funnel optimization for an e-commerce brand.",
    outcome: "+38% conversion rate in 3 months",
    quote: "‚ÄúTagorithm‚Äôs CRO process was transparent, fast, and delivered real results.‚Äù"
  },
  {
    client: "FinTechPro",
    logo: "/bc.png",
    summary: "A/B testing and UX improvements for a SaaS platform.",
    outcome: "+22% signups, -18% bounce rate",
    quote: "‚ÄúWe finally understand what works for our users. Highly recommended!‚Äù"
  }
];

// FAQs
const faqs = [
  {
    q: "How long does a CRO project take?",
    a: "Most projects show measurable results within 4‚Äì8 weeks, depending on traffic and test complexity."
  },
  {
    q: "Do you handle both design and development?",
    a: "Yes! We manage everything from UX research to implementation and reporting."
  },
  {
    q: "Can you work with our in-house team?",
    a: "Absolutely. We can collaborate with your team or manage the entire process."
  }
];
---

<MainLayout title="Conversion Rate Optimization - Tagorithm">
  <main class="space-y-20 md:space-y-32">

    <!-- Hero Section -->
    <section class="relative min-h-[80vh] flex items-center bg-dark overflow-hidden">
      <div class="absolute inset-0">
        <img src="/src/assets/bars.svg" alt="" class="w-full h-full object-cover opacity-[0.03]" />
        <div class="absolute -top-32 -left-32 w-[400px] h-[400px] bg-[#B9FF66]/30 rounded-full blur-3xl"></div>
        <div class="absolute bottom-0 right-0 w-[300px] h-[300px] bg-[#66FFB9]/20 rounded-full blur-2xl"></div>
      </div>
      <div class="container mx-auto px-4 relative z-10 flex flex-col items-center text-center gap-8">
        <h1 class="text-4xl md:text-6xl font-extrabold text-white leading-tight drop-shadow-lg">
          Optimize Every Click. <span class="highlight">Maximize Every Conversion</span>
        </h1>
        <p class="text-lg md:text-2xl text-gray-200 max-w-2xl mx-auto">
          We turn traffic into revenue with data-driven CRO strategies, testing, and design.
        </p>
        <a href="#contact" class="btn-primary px-8 py-4 text-lg shadow-lg hover:scale-105 transition-transform">Start Optimizing</a>
        <span class="mt-8 animate-bounce text-[#B9FF66] text-3xl">&#8595;</span>
      </div>
    </Section>

    <!-- What We Do -->
    <section class="container mx-auto px-4">
      <SectionTitle sectionTitle="What We Do" description="Full-funnel CRO services for sustainable growth." />
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mt-10">
        {croServices.map(s => (
          <div class="bg-white rounded-2xl p-6 flex flex-col items-center text-center shadow-md hover:shadow-xl border-t-4 border-transparent hover:border-[#B9FF66] transition-all group">
            <div class="text-4xl mb-4 w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-[#B9FF66]/70 to-[#66FFB9]/70 text-white shadow-lg group-hover:scale-110 transition-transform">{s.icon}</div>
            <h3 class="text-lg font-bold mb-2">{s.title}</h3>
            <p class="text-gray-600">{s.desc}</p>
          </div>
        ))}
      </div>
    </section>

    <!-- Why It Matters -->
    <section class="container mx-auto px-4">
      <SectionTitle sectionTitle="Why CRO Matters" />
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mt-10">
        {whyMatters.map(item => (
          <div class="bg-[#F8FFF3] rounded-xl p-6 flex flex-col items-center text-center shadow-sm">
            <div class="text-3xl mb-3">{item.icon}</div>
            <h4 class="font-semibold mb-1">{item.title}</h4>
            <p class="text-gray-600 text-sm">{item.desc}</p>
          </div>
        ))}
      </div>
    </section>

    <!-- Our Approach -->
    <section class="container mx-auto px-4">
      <SectionTitle sectionTitle="Our Approach" />
      <ol class="relative border-l-2 border-[#B9FF66]/40 max-w-2xl mx-auto mt-10 space-y-8">
        {approach.map(step => (
          <li class="ml-6">
            <span class="absolute -left-4 flex items-center justify-center w-8 h-8 bg-gradient-to-br from-[#B9FF66] to-[#66FFB9] rounded-full text-white font-bold shadow-lg">{step.step}</span>
            <div class="pl-4">
              <h5 class="font-bold text-lg mb-1">{step.title}</h5>
              <p class="text-gray-600">{step.desc}</p>
            </div>
          </li>
        ))}
      </ol>
    </section>

    <!-- Case Studies -->
    <section class="container mx-auto px-4">
      <SectionTitle sectionTitle="Case Studies" description="CRO wins for real brands." />
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-10">
        {cases.map(cs => (
          <div class="bg-white rounded-2xl p-6 shadow-lg flex flex-col gap-4">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 bg-[#B9FF66]/20 rounded-full flex items-center justify-center">
                {cs.logo ? <img src={cs.logo} alt={cs.client + ' logo'} class="w-8 h-8 object-contain" /> : <span class="font-bold text-lg">{cs.client[0]}</span>}
              </div>
              <div>
                <h4 class="font-bold">{cs.client}</h4>
                <p class="text-sm text-gray-500">{cs.summary}</p>
              </div>
            </div>
            <div class="text-[#4ECDC4] font-semibold">{cs.outcome}</div>
            <blockquote class="italic text-gray-700 border-l-4 border-[#B9FF66] pl-4">{cs.quote}</blockquote>
          </div>
        ))}
      </div>
    </section>

    <!-- FAQs -->
    <section class="container mx-auto px-4">
      <SectionTitle sectionTitle="FAQs" />
      <div class="max-w-2xl mx-auto mt-8 space-y-4">
        {faqs.map((faq, i) => (
          <details class="bg-white rounded-xl shadow p-4 group" open={i === 0}>
            <summary class="font-semibold cursor-pointer outline-none group-open:text-[#B9FF66]">{faq.q}</summary>
            <div class="mt-2 text-gray-600">{faq.a}</div>
          </details>
        ))}
      </div>
    </section>

    <!-- Final CTA Banner -->
    <section class="w-full bg-gradient-to-br from-[#B9FF66]/20 to-[#66FFB9]/20 py-16 mt-12">
      <div class="container mx-auto px-4 flex flex-col md:flex-row items-center justify-between gap-8">
        <div class="space-y-4 md:w-2/3">
          <h2 class="text-2xl md:text-3xl font-bold">Ready to boost your conversions?</h2>
          <p class="text-lg text-gray-700">Schedule a free CRO audit or chat with our experts today.</p>
        </div>
        <a href="#contact" class="btn-primary px-8 py-4 text-lg shadow-lg hover:scale-105 transition-transform">Schedule a CRO Audit</a>
      </div>
    </section>

    <!-- Contact Form -->
    <section id="contact" class="container mx-auto px-4 py-16">
      <SectionTitle sectionTitle="Get Started" description="Tell us about your optimization goals and let's begin improving." />
      <Form />
    </section>
  </main>
</MainLayout>

<style>
  .btn-primary {
    @apply bg-[#B9FF66] text-black font-bold rounded-full px-6 py-3 transition-colors hover:bg-[#66FFB9] focus:outline-none focus:ring-2 focus:ring-[#B9FF66];
  }
  .highlight {
    background-color: white;
    color: #B9FF66;
    padding: 0 0.02em;
    border-radius: 0.4em;
    text-shadow:
      -1px -1px 0 #000,
       1px -1px 0 #000,
      -1px  1px 0 #000,
       1px  1px 0 #000;
    -webkit-text-stroke: 0.5px black;
  }

  /* Typography improvements */
  h1, h2, h3, h4 {
    letter-spacing: -0.02em;
  }

  .content-text {
    color: rgb(75, 85, 99); /* Instead of @apply text-gray-600 */
    line-height: 1.75; /* Instead of @apply leading-relaxed */
    font-size: clamp(1rem, 1.5vw, 1.125rem);
  }

  /* Swiper navigation improvements */
  .swiper-button-next,
  .swiper-button-prev {
    width: 40px;
    height: 40px;
    background: white;
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }

  .swiper-button-next:hover,
  .swiper-button-prev:hover {
    background: #B9FF66;
    color: white !important;
  }

  .swiper-button-next::after,
  .swiper-button-prev::after {
    font-size: 18px;
    font-weight: bold;
  }

  /* Pagination improvements */
  .swiper-pagination-bullet {
    width: 8px;
    height: 8px;
    transition: all 0.3s ease;
  }

  .swiper-pagination-bullet-active {
    background: #B9FF66;
    width: 24px;
    border-radius: 4px;
  }

  /* Fade in animation */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fadeInUp {
    animation: fadeInUp 0.6s ease forwards;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .swiper-slide {
    height: auto;
    display: flex;
  }

  .swiper-slide > div {
    height: 100%;
    width: 100%;
  }
</style>

<script>
  import Swiper from 'swiper';
  import { Navigation, Pagination, Autoplay } from 'swiper/modules';

  new Swiper('.case-studies-swiper', {
    modules: [Navigation, Pagination, Autoplay],
    slidesPerView: 1,
    spaceBetween: 24,
    loop: true,
    centeredSlides: true,
    autoplay: {
      delay: 5000,
      disableOnInteraction: false,
    },
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
    },
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    breakpoints: {
      640: {
        slidesPerView: 1,
        spaceBetween: 20,
      },
      768: {
        slidesPerView: 1.5,
        spaceBetween: 24,
      },
      1024: {
        slidesPerView: 2,
        spaceBetween: 24,
      },
      1280: {
        slidesPerView: 3,
        spaceBetween: 24,
      }
    },
  });

  // Using Intersection Observer for scroll animations
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('animate-fadeInUp');
      }
    });
  }, {
    threshold: 0.1
  });

  document.querySelectorAll('section').forEach(section => {
    observer.observe(section);
  });
</script>
